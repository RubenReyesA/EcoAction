{"remainingRequest":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue?vue&type=template&id=2335e730","dependencies":[{"path":"/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue","mtime":1610360119520},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgPGlvbi1ncmlkIGlkPSJoZWxsb0NvbnRhaW5lciI+CiAgICA8aW9uLXJvdz4KICAgICAgPGlvbi1jb2wgY2xhc3M9Imlvbi1wYWRkaW5nIj4KICAgICAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgICAgICAgPGlvbi1idXR0b24gQGNsaWNrPSJnb3RvTG9naW4oY29udHJvbCkiCiAgICAgICAgICAgID5Mb2dpbiBleGlzdGluZyBhY2NvdW50PC9pb24tYnV0dG9uCiAgICAgICAgICA+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvaW9uLWNvbD4KICAgIDwvaW9uLXJvdz4KCiAgICA8aW9uLXJvdz4KICAgICAgPGlvbi1jb2wgY2xhc3M9Imlvbi1wYWRkaW5nIj4KICAgICAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgICAgICAgPGlvbi1idXR0b24gQGNsaWNrPSJnb3RvUmVnaXN0ZXIiPlJlZ2lzdGVyPC9pb24tYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgICA8L2lvbi1jb2w+CiAgICA8L2lvbi1yb3c+CiAgPC9pb24tZ3JpZD4K"},{"version":3,"sources":["/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACpC;QACF,CAAC,CAAC,CAAC,CAAC,CAAC;MACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;IAET,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC,CAAC,CAAC;MACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue","sourceRoot":"","sourcesContent":["<template>\n  <ion-grid id=\"helloContainer\">\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoLogin(control)\"\n            >Login existing account</ion-button\n          >\n        </div>\n      </ion-col>\n    </ion-row>\n\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoRegister\">Register</ion-button>\n        </div>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</template>\n\n<script>\nimport {\n  IonGrid,\n  IonRow,\n  IonCol,\n  IonButton,\n  loadingController,\n} from \"@ionic/vue\";\nimport { useRouter } from \"vue-router\";\n\nimport { defineComponent } from \"vue\";\nimport { NativeStorage } from \"@ionic-native/native-storage\";\nimport { KeychainTouchId } from \"@ionic-native/keychain-touch-id\";\nimport axios from \"axios\";\nimport sha256 from \"js-sha256\";\n\nimport EventBus from \"eventing-bus\";\n\nexport default defineComponent({\n  name: \"LoginRegisterSession\",\n  props: {},\n  components: {\n    IonGrid,\n    IonRow,\n    IonCol,\n    IonButton,\n  },\n  data: function () {\n    return {\n      control: null,\n    };\n  },\n  setup() {\n    const router = useRouter();\n\n    const gotoLogin = (c) => {\n      NativeStorage.getItem(\"loginPRO\")\n        .then((res) => {\n          KeychainTouchId.isAvailable()\n            .then(() => {\n              KeychainTouchId.verify(\"loginCredentials\", \"Use to login\")\n                .then((res2) => {\n                  loadingController\n                    .create({\n                      message: \"Iniciando sesión...\",\n                    })\n                    .then((loading) => {\n                      c = loading;\n                      loading.present();\n                      axios({\n                        url: \"http://192.168.1.41:3013/loginUser\",\n                        method: \"post\",\n                        headers: { Accept: \"application/json\" },\n                        data: {\n                          mail: res,\n                        },\n                      })\n                        .then((response) => {\n                          if (response.status == 200) {\n                            c.dismiss();\n                            if (sha256(res2) == response.data) {\n                              alert(\"Sesión iniciada correctamente\");\n\n                              axios({\n                                url:\n                                  \"http://192.168.1.41:3013/getUserName?mail=\" +\n                                  res,\n                                method: \"get\",\n                              }).then((response) => {\n                                NativeStorage.setItem(\"login\", response.data);\n                                EventBus.publish(\"hi\");\n                                EventBus.publish(\"checkBiometrics\");\n                              });\n\n                              axios({\n                                url:\n                                  \"http://192.168.1.41:3013/getTokenAddress?mail=\" +\n                                  res,\n                                method: \"get\",\n                              }).then((response) => {\n                                NativeStorage.setItem(\n                                  \"tokenAddress\",\n                                  response.data\n                                );\n                                //EventBus.publish(\"hi\");\n                              });\n                            } else {\n                              alert(\"Contraseña incorrecta!\");\n                            }\n                          } else {\n                            c.dismiss();\n                            alert(\n                              \"This mail is not registered in the system. Please register or use another mail\"\n                            );\n                            router.push(\"/main/home/login\");\n                          }\n                        })\n                        .catch((err) => {\n                          c.dismiss();\n                          alert(\"Se ha producido un error: \" + err);\n                          router.push(\"/main/home/login\");\n                        });\n                    });\n                })\n                .catch((err2) => {\n                  alert(\"Error keychain: \" + err2);\n                  router.push(\"/main/home/login\");\n                });\n            })\n            .catch((err) => {\n              alert(\"Error: \" + err);\n              router.push(\"/main/home/login\");\n            });\n        })\n        .catch(() => {\n          router.push(\"/main/home/login\");\n        });\n    };\n\n    const gotoRegister = () => {\n      router.push(\"/main/home/register\");\n    };\n\n    return {\n      gotoLogin,\n      gotoRegister,\n    };\n  },\n});\n</script>\n\n<style>\n@import \"../styles/homeStyle.css\";\n</style>"]}]}