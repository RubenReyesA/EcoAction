{"remainingRequest":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/src/components/GMap.vue?vue&type=style&index=0&id=36c7e925&lang=css","dependencies":[{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/src/components/GMap.vue","mtime":1612259154640},{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgIi4uL3N0eWxlcy9zdHlsZS5jc3MiOwo="},{"version":3,"sources":["/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/src/components/GMap.vue"],"names":[],"mappings":";AAyIA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Volumes/DATA SHARE/Trabajos 4t-UAB/TFG/Projecte/ecoAction/src/components/GMap.vue","sourceRoot":"","sourcesContent":["<template>\n  <div id=\"map\" ref=\"mapDivRef\"></div>\n</template>\n\n<script>\nimport { ref, onMounted } from \"vue\";\n\nimport EventBus from \"eventing-bus\";\n\nimport MarkerClusterer from '@googlemaps/markerclustererplus';\n\nexport default {\n  name: \"GMap\",\n  props: {\n    center: { lat: Number, lng: Number },\n    markers: Array,\n    zoom: Number,\n    mapType: String,\n    disableUI: Boolean,\n  },\n  created: function () {\n    EventBus.on(\"markersUpdate\", this.checkMyMarker);\n  },\n  methods: {\n    checkMyMarker: function () {\n      console.log(33);\n      window.createMyMarker();\n    },\n  },\n  setup(props) {\n    //const map = ref(null);\n    const mapDivRef = ref(null);\n\n    let mapeo = null;\n\n    onMounted(() => {\n      //const key = \"AIzaSyCX6DY6Q0JYgekyFRtC0r7mrkDDXtxxcSU\";\n      const key = \"\";\n\n      // create the script element to load\n      const googleMapScript = document.createElement(\"SCRIPT\");\n      googleMapScript.setAttribute(\n        \"src\",\n        `https://maps.googleapis.com/maps/api/js?key=${key}&callback=initMap`\n      );\n      googleMapScript.setAttribute(\"defer\", \"\");\n      googleMapScript.setAttribute(\"async\", \"\");\n      document.head.appendChild(googleMapScript);\n\n    });\n\n    const markersList = [];\n    let myMarker = null;\n\n    window.createMyMarker = () => {\n      if (myMarker != null) {\n        myMarker.setMap(null);\n      }\n\n      myMarker = new window.google.maps.Marker({\n        position: new window.google.maps.LatLng(\n          props.center.lat,\n          props.center.lng\n        ),\n        map: mapeo,\n        icon: {\n          path: window.google.maps.SymbolPath.CIRCLE,\n          scale: 10,\n          fillOpacity: 1,\n          strokeWeight: 2,\n          fillColor: \"#5384ED\",\n          strokeColor: \"#ffffff\",\n        },\n      });\n    };\n\n    window.initMap = () => {\n      mapeo = new window.google.maps.Map(mapDivRef.value, {\n        mapTypeId: props.mapType,\n        zoom: props.zoom,\n        disableDefaultUI: props.disableUI,\n        center: props.center,\n      });\n\n      window.a = function (code) {\n        EventBus.publish('openDetails', code);\n      };\n\n      window.createMyMarker();\n\n      props.markers.forEach((markerInfo) => {\n        const mapMarker = new window.google.maps.Marker({\n          position: new window.google.maps.LatLng(\n            markerInfo.lat,\n            markerInfo.lng\n          ),\n          map: mapeo,\n          title: markerInfo.title,\n        });\n\n        mapMarker.infoWindow = new window.google.maps.InfoWindow({\n          content: `<h2 onclick=\"a('${markerInfo.id}')\" style=\"color: #5e9ca0; text-align: center;\">${markerInfo.title}</h2>`,\n        });\n\n        markersList.push(mapMarker);\n      });\n\n      markersList.forEach((m) => {\n        m.addListener(\"click\", () => {\n          if (m.infoWindow != null) {\n            m.infoWindow.open(mapeo, m);\n          }\n        });\n      });\n\n      \n      new MarkerClusterer(\n        mapeo,\n        markersList,\n        {\n          imagePath:\n            \"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m\",\n        }\n      );\n      \n    };\n\n    return {\n      mapDivRef,\n      markersList,\n      mapeo\n    };\n  },\n};\n</script>\n\n<style>\n@import \"../styles/style.css\";\n</style>"]}]}