{"remainingRequest":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue?vue&type=style&index=0&id=9163ee8c&lang=css","dependencies":[{"path":"/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue","mtime":1610116187068},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/myApp/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgIi4uL3N0eWxlcy9ob21lU3R5bGUuY3NzIjsK"},{"version":3,"sources":["/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue"],"names":[],"mappings":";AAqHA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/Users/ruben107/Documents/Alfa/myApp/src/components/LoginRegisterSession.vue","sourceRoot":"","sourcesContent":["<template>\n  <ion-grid id=\"helloContainer\">\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoLogin\">Login existing account</ion-button>\n        </div>\n      </ion-col>\n    </ion-row>\n\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoRegister\">Register</ion-button>\n        </div>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</template>\n\n<script>\nimport {\n  IonGrid,\n  IonRow,\n  IonCol,\n  IonButton,\n  loadingController,\n} from \"@ionic/vue\";\nimport { useRouter } from \"vue-router\";\n\nimport { defineComponent } from \"vue\";\nimport { NativeStorage } from \"@ionic-native/native-storage\";\nimport { KeychainTouchId } from \"@ionic-native/keychain-touch-id\";\nimport axios from \"axios\";\nimport sha256 from \"js-sha256\";\n\nexport default defineComponent({\n  name: \"LoginRegisterSession\",\n  props: {},\n  components: {\n    IonGrid,\n    IonRow,\n    IonCol,\n    IonButton,\n  },\n  setup() {\n    const router = useRouter();\n\n    const gotoLogin = () => {\n      NativeStorage.getItem(\"loginPRO\")\n        .then((res) => {\n          KeychainTouchId.isAvailable()\n            .then(() => {\n              KeychainTouchId.verify(\"loginCredentials\", \"Use to login\")\n                .then((res2) => {\n                  alert(res2);\n                  loadingController\n                    .create({\n                      message: \"Iniciando sesión...\",\n                    })\n                    .then((loading) => {\n                      this.control = loading;\n                      loading.present();\n                      axios({\n                        url: \"http://192.168.1.41:3013/loginUser\",\n                        method: \"post\",\n                        headers: { Accept: \"application/json\" },\n                        data: {\n                          mail: res,\n                        },\n                      })\n                        .then((response) => {\n                          if (response.status == 200) {\n                            this.control.dismiss();\n                            if (sha256(res2 == response.data)) {\n                              alert(\"Sesión iniciada correctamente\");\n                              NativeStorage.setItem(\"login\", \"TEST_NAME\");\n                            } else {\n                              alert(\"Contraseña incorrecta!\");\n                            }\n                          } else {\n                            this.control.dismiss();\n                            alert(\n                              \"This mail is not registered in the system. Please register or use another mail\"\n                            );\n                          }\n                        })\n                        .catch((err) => {\n                          this.control.dismiss();\n                          alert(\"Se ha producido un error: \" + err);\n                        });\n                    });\n                })\n                .catch((err2) => {\n                  alert(\"Error keychain: \" + err2);\n                });\n            })\n            .catch((err) => alert(\"Error: \" + err));\n        })\n        .catch(() => {\n          router.push(\"/main/home/login\");\n        });\n    };\n\n    const gotoRegister = () => {\n      router.push(\"/main/home/register\");\n    };\n\n    return {\n      gotoLogin,\n      gotoRegister,\n    };\n  },\n});\n</script>\n\n<style>\n@import \"../styles/homeStyle.css\";\n</style>"]}]}