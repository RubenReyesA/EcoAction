{"remainingRequest":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/thread-loader/dist/cjs.js!/Users/ruben107/Documents/Alfa/ecoAction/node_modules/babel-loader/lib/index.js!/Users/ruben107/Documents/Alfa/ecoAction/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ruben107/Documents/Alfa/ecoAction/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/ruben107/Documents/Alfa/ecoAction/src/components/LoginRegisterSession.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/ruben107/Documents/Alfa/ecoAction/src/components/LoginRegisterSession.vue","mtime":1610360119520},{"path":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ruben107/Documents/Alfa/ecoAction/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgSW9uR3JpZCwgSW9uUm93LCBJb25Db2wsIElvbkJ1dHRvbiwgbG9hZGluZ0NvbnRyb2xsZXIgfSBmcm9tICJAaW9uaWMvdnVlIjsKaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAidnVlLXJvdXRlciI7CmltcG9ydCB7IGRlZmluZUNvbXBvbmVudCB9IGZyb20gInZ1ZSI7CmltcG9ydCB7IE5hdGl2ZVN0b3JhZ2UgfSBmcm9tICJAaW9uaWMtbmF0aXZlL25hdGl2ZS1zdG9yYWdlIjsKaW1wb3J0IHsgS2V5Y2hhaW5Ub3VjaElkIH0gZnJvbSAiQGlvbmljLW5hdGl2ZS9rZXljaGFpbi10b3VjaC1pZCI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBzaGEyNTYgZnJvbSAianMtc2hhMjU2IjsKaW1wb3J0IEV2ZW50QnVzIGZyb20gImV2ZW50aW5nLWJ1cyI7CmV4cG9ydCBkZWZhdWx0IGRlZmluZUNvbXBvbmVudCh7CiAgbmFtZTogIkxvZ2luUmVnaXN0ZXJTZXNzaW9uIiwKICBwcm9wczoge30sCiAgY29tcG9uZW50czogewogICAgSW9uR3JpZDogSW9uR3JpZCwKICAgIElvblJvdzogSW9uUm93LAogICAgSW9uQ29sOiBJb25Db2wsCiAgICBJb25CdXR0b246IElvbkJ1dHRvbgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNvbnRyb2w6IG51bGwKICAgIH07CiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICB2YXIgcm91dGVyID0gdXNlUm91dGVyKCk7CgogICAgdmFyIGdvdG9Mb2dpbiA9IGZ1bmN0aW9uIGdvdG9Mb2dpbihjKSB7CiAgICAgIE5hdGl2ZVN0b3JhZ2UuZ2V0SXRlbSgibG9naW5QUk8iKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBLZXljaGFpblRvdWNoSWQuaXNBdmFpbGFibGUoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEtleWNoYWluVG91Y2hJZC52ZXJpZnkoImxvZ2luQ3JlZGVudGlhbHMiLCAiVXNlIHRvIGxvZ2luIikudGhlbihmdW5jdGlvbiAocmVzMikgewogICAgICAgICAgICBsb2FkaW5nQ29udHJvbGxlci5jcmVhdGUoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICJJbmljaWFuZG8gc2VzacOzbi4uLiIKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAobG9hZGluZykgewogICAgICAgICAgICAgIGMgPSBsb2FkaW5nOwogICAgICAgICAgICAgIGxvYWRpbmcucHJlc2VudCgpOwogICAgICAgICAgICAgIGF4aW9zKHsKICAgICAgICAgICAgICAgIHVybDogImh0dHA6Ly8xOTIuMTY4LjEuNDE6MzAxMy9sb2dpblVzZXIiLAogICAgICAgICAgICAgICAgbWV0aG9kOiAicG9zdCIsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgIEFjY2VwdDogImFwcGxpY2F0aW9uL2pzb24iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICBtYWlsOiByZXMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgYy5kaXNtaXNzKCk7CgogICAgICAgICAgICAgICAgICBpZiAoc2hhMjU2KHJlczIpID09IHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgiU2VzacOzbiBpbmljaWFkYSBjb3JyZWN0YW1lbnRlIik7CiAgICAgICAgICAgICAgICAgICAgYXhpb3MoewogICAgICAgICAgICAgICAgICAgICAgdXJsOiAiaHR0cDovLzE5Mi4xNjguMS40MTozMDEzL2dldFVzZXJOYW1lP21haWw9IiArIHJlcywKICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogImdldCIKICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgTmF0aXZlU3RvcmFnZS5zZXRJdGVtKCJsb2dpbiIsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMucHVibGlzaCgiaGkiKTsKICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLnB1Ymxpc2goImNoZWNrQmlvbWV0cmljcyIpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGF4aW9zKHsKICAgICAgICAgICAgICAgICAgICAgIHVybDogImh0dHA6Ly8xOTIuMTY4LjEuNDE6MzAxMy9nZXRUb2tlbkFkZHJlc3M/bWFpbD0iICsgcmVzLAogICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiZ2V0IgogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICBOYXRpdmVTdG9yYWdlLnNldEl0ZW0oInRva2VuQWRkcmVzcyIsIHJlc3BvbnNlLmRhdGEpOyAvL0V2ZW50QnVzLnB1Ymxpc2goImhpIik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkNvbnRyYXNlw7FhIGluY29ycmVjdGEhIik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGMuZGlzbWlzcygpOwogICAgICAgICAgICAgICAgICBhbGVydCgiVGhpcyBtYWlsIGlzIG5vdCByZWdpc3RlcmVkIGluIHRoZSBzeXN0ZW0uIFBsZWFzZSByZWdpc3RlciBvciB1c2UgYW5vdGhlciBtYWlsIik7CiAgICAgICAgICAgICAgICAgIHJvdXRlci5wdXNoKCIvbWFpbi9ob21lL2xvZ2luIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgYy5kaXNtaXNzKCk7CiAgICAgICAgICAgICAgICBhbGVydCgiU2UgaGEgcHJvZHVjaWRvIHVuIGVycm9yOiAiICsgZXJyKTsKICAgICAgICAgICAgICAgIHJvdXRlci5wdXNoKCIvbWFpbi9ob21lL2xvZ2luIik7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycjIpIHsKICAgICAgICAgICAgYWxlcnQoIkVycm9yIGtleWNoYWluOiAiICsgZXJyMik7CiAgICAgICAgICAgIHJvdXRlci5wdXNoKCIvbWFpbi9ob21lL2xvZ2luIik7CiAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlcnIpOwogICAgICAgICAgcm91dGVyLnB1c2goIi9tYWluL2hvbWUvbG9naW4iKTsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgIHJvdXRlci5wdXNoKCIvbWFpbi9ob21lL2xvZ2luIik7CiAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgZ290b1JlZ2lzdGVyID0gZnVuY3Rpb24gZ290b1JlZ2lzdGVyKCkgewogICAgICByb3V0ZXIucHVzaCgiL21haW4vaG9tZS9yZWdpc3RlciIpOwogICAgfTsKCiAgICByZXR1cm4gewogICAgICBnb3RvTG9naW46IGdvdG9Mb2dpbiwKICAgICAgZ290b1JlZ2lzdGVyOiBnb3RvUmVnaXN0ZXIKICAgIH07CiAgfQp9KTs="},{"version":3,"sources":["/Users/ruben107/Documents/Alfa/ecoAction/src/components/LoginRegisterSession.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <ion-grid id=\"helloContainer\">\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoLogin(control)\"\n            >Login existing account</ion-button\n          >\n        </div>\n      </ion-col>\n    </ion-row>\n\n    <ion-row>\n      <ion-col class=\"ion-padding\">\n        <div class=\"container\">\n          <ion-button @click=\"gotoRegister\">Register</ion-button>\n        </div>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</template>\n\n<script>\nimport {\n  IonGrid,\n  IonRow,\n  IonCol,\n  IonButton,\n  loadingController,\n} from \"@ionic/vue\";\nimport { useRouter } from \"vue-router\";\n\nimport { defineComponent } from \"vue\";\nimport { NativeStorage } from \"@ionic-native/native-storage\";\nimport { KeychainTouchId } from \"@ionic-native/keychain-touch-id\";\nimport axios from \"axios\";\nimport sha256 from \"js-sha256\";\n\nimport EventBus from \"eventing-bus\";\n\nexport default defineComponent({\n  name: \"LoginRegisterSession\",\n  props: {},\n  components: {\n    IonGrid,\n    IonRow,\n    IonCol,\n    IonButton,\n  },\n  data: function () {\n    return {\n      control: null,\n    };\n  },\n  setup() {\n    const router = useRouter();\n\n    const gotoLogin = (c) => {\n      NativeStorage.getItem(\"loginPRO\")\n        .then((res) => {\n          KeychainTouchId.isAvailable()\n            .then(() => {\n              KeychainTouchId.verify(\"loginCredentials\", \"Use to login\")\n                .then((res2) => {\n                  loadingController\n                    .create({\n                      message: \"Iniciando sesión...\",\n                    })\n                    .then((loading) => {\n                      c = loading;\n                      loading.present();\n                      axios({\n                        url: \"http://192.168.1.41:3013/loginUser\",\n                        method: \"post\",\n                        headers: { Accept: \"application/json\" },\n                        data: {\n                          mail: res,\n                        },\n                      })\n                        .then((response) => {\n                          if (response.status == 200) {\n                            c.dismiss();\n                            if (sha256(res2) == response.data) {\n                              alert(\"Sesión iniciada correctamente\");\n\n                              axios({\n                                url:\n                                  \"http://192.168.1.41:3013/getUserName?mail=\" +\n                                  res,\n                                method: \"get\",\n                              }).then((response) => {\n                                NativeStorage.setItem(\"login\", response.data);\n                                EventBus.publish(\"hi\");\n                                EventBus.publish(\"checkBiometrics\");\n                              });\n\n                              axios({\n                                url:\n                                  \"http://192.168.1.41:3013/getTokenAddress?mail=\" +\n                                  res,\n                                method: \"get\",\n                              }).then((response) => {\n                                NativeStorage.setItem(\n                                  \"tokenAddress\",\n                                  response.data\n                                );\n                                //EventBus.publish(\"hi\");\n                              });\n                            } else {\n                              alert(\"Contraseña incorrecta!\");\n                            }\n                          } else {\n                            c.dismiss();\n                            alert(\n                              \"This mail is not registered in the system. Please register or use another mail\"\n                            );\n                            router.push(\"/main/home/login\");\n                          }\n                        })\n                        .catch((err) => {\n                          c.dismiss();\n                          alert(\"Se ha producido un error: \" + err);\n                          router.push(\"/main/home/login\");\n                        });\n                    });\n                })\n                .catch((err2) => {\n                  alert(\"Error keychain: \" + err2);\n                  router.push(\"/main/home/login\");\n                });\n            })\n            .catch((err) => {\n              alert(\"Error: \" + err);\n              router.push(\"/main/home/login\");\n            });\n        })\n        .catch(() => {\n          router.push(\"/main/home/login\");\n        });\n    };\n\n    const gotoRegister = () => {\n      router.push(\"/main/home/register\");\n    };\n\n    return {\n      gotoLogin,\n      gotoRegister,\n    };\n  },\n});\n</script>\n\n<style>\n@import \"../styles/homeStyle.css\";\n</style>"],"sourceRoot":""}]}